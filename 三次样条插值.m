x=[-1:0.001:1];
f=1./(1+25*x.*x);
xj=[-1:h:1];
fj=1./(1+25*xj.*xj);
% p1=[0.912229,-0.936884,-0.873767,1.93688;
% -0.936884,0.912229,1.93688,-0.873767];
% p1=[-1.2999,  3.09971,  0.401899,  -0.499065;
%     3.09971,  -4.99813, -0.499065, 3.24953;
%     -4.99813, 3.09971,  3.24953,   -0.499065;
%     3.09971,  -1.2999,  -0.499065, 0.401899
%     ];
% p1=[0.828698,  -1.13218,  0.0233071,   0.373504;
%     -1.13218,  7.42683,   0.373504,    -0.0310852;
%     7.42683,   -13.6399 , -0.0310852,  4.51554;
%     -13.6399,  7.42683  , 4.51554,     -0.0310852;
%     7.42683 ,  -1.13218 , -0.0310852,  0.373504;
%     -1.13218,  0.828698 , 0.373504 ,   0.0233071;
%     ];
% p1=[-0.105805 0.815602  0.160459  0.214585;
%    0.815602  -0.365405 0.214585  0.574562;
%    -0.365405 12.2154   0.574562  0.797512;
%    12.2154   -25.6199  0.797512  5.60124;
%    -25.6199  12.2154   5.60124   0.797512;
%    12.2154   -0.365405 0.797512  0.574562;
%    -0.365405 0.815602  0.574562  0.214585;
%    0.815602  -0.105805 0.214585  0.160459;
%     ];
p1=[0.204629  0.286879  0.184123  0.282642;
    0.286879  1.24967   0.282642  0.450013;
    1.24967   2.0674    0.450013  0.917304;
    2.0674    15.4807   0.917304  1.88077;
    15.4807   -38.9904  1.88077   6.55961;
    -38.9904  15.4807   6.55961   1.88077;
    15.4807   2.0674    1.88077   0.917304;
    2.0674    1.24967   0.917304  0.450013;
    1.24967   0.286879  0.450013  0.282642;
    0.286879  0.204629  0.282642  0.184123
    ];
S=zeros(n,length(x));
for i=1:n
    S(i,:)=p1(i,1)*(xj(i+1)-x).*(xj(i+1)-x).*(xj(i+1)-x)...
         +p1(i,2)*(x-xj(i)).*(x-xj(i)).*(x-xj(i))...
         +p1(i,3)*(xj(i+1)-x)...
         +p1(i,4)*(x-xj(i));
end;
figure(3);
plot(x,f);
hold on;
for i=1:n
    %plot(x,S(i,:));
     plot(x(fix(h/0.001)*(i-1)+1:fix(h/0.001)*i+1),S(i,fix(h/0.001)*(i-1)+1:fix(h/0.001)*i+1));
    hold on;
end;
legend('f(x)'...
      ,'S1(x)'...
      ,'S2(x)'...
      ,'S3(x)'...
      ,'S4(x)'...
      ,'S5(x)'...
      ,'S6(x)'...
      ,'S7(x)'...
      ,'S8(x)'...
      ,'S9(x)'...
      ,'S10(x)'...
      );
  
e=zeros(n,length(x));
for i=1:n,
    e(i,:)=abs((f-S(i,:))./f);
end;
Em=-1;
for i=1:n
    for j=fix(h/0.001)*(i-1)+1:fix(h/0.001)*i+1,
        if Em<e(i,j),
           Em=e(i,j);
           xm=-1+j*0.001;
        end
    end
end
 figure(4);
 for i=1:n
    plot(x(fix(h/0.001)*(i-1)+1:fix(h/0.001)*i+1),e(i,fix(h/0.001)*(i-1)+1:fix(h/0.001)*i+1));
    hold on;
end;
legend('e1(x)'...
      ,'e2(x)'...
      ,'e3(x)'...
      ,'e4(x)'...
      ,'e5(x)'...
      ,'e6(x)'...
      ,'e7(x)'...
      ,'e8(x)'...
      ,'e9(x)'...
      ,'e10(x)'...
      );
disp(xm);
disp(Em);